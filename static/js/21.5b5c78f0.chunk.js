(this.webpackJsonppwa=this.webpackJsonppwa||[]).push([[21],{2052:function(e,t,a){"use strict";a.r(t);var n=a(524),r=a.n(n),s=a(567),o=a(31),i=a(32),c=a(34),l=a(33),u=a(4),d=a.n(u),m=a(35),p=a(559),h=a(548),b=a(543),f=a(622),v=a(2016),g=a(2041),y=a(2002),E=a(2006),S=a(2010),k=a(2011),w=a(2012),O=a(2013),x=a(642),V=a(1076),C=a.n(V),T=a(1945),j=a(1797),_=a(1794),I=a(2025),A=a(2009),M=a(2024),N=a(2053),L=a(871),D=a.n(L),W=a(1795),B=a.n(W),U=a(681),R=a.n(U),J=a(1796),F=a.n(J),P=a(672),z=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={countdown:{}},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.votings,n=t.loading,r=t.expertmode,s=t.t,o=t.localAuditTrail,i=t.expanded,c=t.totalShares,l=t.networkName;return d.a.createElement(d.a.Fragment,null,a&&Object.keys(a).length>0?Object.keys(a).map((function(t){return d.a.createElement(T.a,{expanded:i===t,onChange:e.props.handleChange(t),key:t,TransitionProps:{unmountOnExit:!0}},d.a.createElement(_.a,{expandIcon:d.a.createElement(D.a,null),"aria-controls":t+"-body",id:t+"header"},a[t].closed&&d.a.createElement(N.a,{disableFocusListener:!0,title:s("base.votingStatusClosed")},d.a.createElement(R.a,{className:"iconMarginRight"})),a[t].running&&d.a.createElement(N.a,{disableFocusListener:!0,title:s("base.votingStatusActive")},d.a.createElement(B.a,{className:"iconMarginRight"})),!a[t].running&&!a[t].closed&&d.a.createElement(N.a,{disableFocusListener:!0,title:s("base.votingStatusWaiting")},d.a.createElement(F.a,{className:"iconMarginRight"})),d.a.createElement(y.a,{variant:"body1"},a[t].title)),d.a.createElement(j.a,null,d.a.createElement(g.a,{width:"100%"},a[t]&&d.a.createElement(d.a.Fragment,null,d.a.createElement(y.a,{variant:"body2",gutterBottom:!0},s("base.status"),": ",a[t].running?s("base.voteOpen"):a[t].closed?s("base.voteClosed"):a[t].starttime>0?s("base.voteWaiting"):s("base.voteUndefined")),a[t].starttime>0?d.a.createElement(y.a,{variant:"body2",gutterBottom:!0},s("base.runtime",{starttime:a[t].starttime,endtime:a[t].endtime})):d.a.createElement(d.a.Fragment,null),d.a.createElement(y.a,{variant:"body2",gutterBottom:!0},a[t].purpose),r&&d.a.createElement(g.a,{my:3},d.a.createElement(y.a,{variant:"body2",gutterBottom:!0},"Ballot address: ",t),d.a.createElement(E.a,{disabled:n,color:"primary",variant:"outlined",component:"a",href:"https://"+l+".etherscan.io/address/"+t,target:"_blank",rel:"noreferrer",startIcon:d.a.createElement(C.a,null)},s("base.viewEtherscan")),"\xa0",d.a.createElement(P.a,{text:t,buttonText:s("base.copyAddressToClipboard")}))),a[t].results&&d.a.createElement(v.a,{container:!0,spacing:1},d.a.createElement(v.a,{item:!0,xs:12,sm:4,md:3},d.a.createElement(y.a,{variant:"body2",align:"right"},s("base.yes")," : ",a[t].results.aye," (",e.props.getVotingShare(a[t].results.aye)," %)")),d.a.createElement(v.a,{item:!0,xs:12,sm:8,md:9},d.a.createElement(M.a,{variant:"determinate",value:e.props.getVotingShare(a[t].results.aye),className:"greenProgress"})),d.a.createElement(v.a,{item:!0,xs:12,sm:4,md:3},d.a.createElement(y.a,{variant:"body2",align:"right"},s("base.no"),": ",a[t].results.nay," (",e.props.getVotingShare(a[t].results.nay)," %)")),d.a.createElement(v.a,{item:!0,xs:12,sm:8,md:9},d.a.createElement(M.a,{variant:"determinate",value:e.props.getVotingShare(a[t].results.nay),className:"redProgress"})),d.a.createElement(v.a,{item:!0,xs:12,sm:4,md:3},d.a.createElement(y.a,{variant:"body2",align:"right"},s("base.abstain"),": ",a[t].results.abstain," (",e.props.getVotingShare(a[t].results.abstain)," %)")),d.a.createElement(v.a,{item:!0,xs:12,sm:8,md:9},d.a.createElement(M.a,{variant:"determinate",value:e.props.getVotingShare(a[t].results.abstain)})),d.a.createElement(v.a,{item:!0,xs:12,sm:4,md:3},d.a.createElement(y.a,{variant:"body2",align:"right"},s("base.standdown"),": ",a[t].results.standDown," (",e.props.getVotingShare(a[t].results.standDown)," %)")),d.a.createElement(v.a,{item:!0,xs:12,sm:8,md:9},d.a.createElement(M.a,{variant:"determinate",value:e.props.getVotingShare(a[t].results.standDown)})),d.a.createElement(v.a,{item:!0,xs:12,sm:4,md:3},d.a.createElement(y.a,{variant:"body2",align:"right"},s("base.notvoted"),":"," ",c-a[t].results.standDown-a[t].results.abstain-a[t].results.nay-a[t].results.aye," ","(",e.props.getVotingShare(c-a[t].results.standDown-a[t].results.abstain-a[t].results.nay-a[t].results.aye)," ","%)")),d.a.createElement(v.a,{item:!0,xs:12,sm:8,md:9},d.a.createElement(M.a,{variant:"determinate",value:e.props.getVotingShare(c-a[t].results.standDown-a[t].results.abstain-a[t].results.nay-a[t].results.aye)}))))),d.a.createElement(I.a,null,d.a.createElement(A.a,{color:"primary",disabled:!a[t].running||a[t].voters||n},d.a.createElement(E.a,{variant:a[t].voters&&o.find((function(e){return e.address===t}))&&"base.yes"===o.find((function(e){return e.address===t})).vote&&"contained",onClick:function(){return e.props.handleModalOpen(t,a[t].title,"base.yes")}},s("base.yes")),d.a.createElement(E.a,{variant:a[t].voters&&o.find((function(e){return e.address===t}))&&"base.no"===o.find((function(e){return e.address===t})).vote&&"contained",onClick:function(){return e.props.handleModalOpen(t,a[t].title,"base.no")}},s("base.no")),d.a.createElement(E.a,{variant:a[t].voters&&o.find((function(e){return e.address===t}))&&"base.abstain"===o.find((function(e){return e.address===t})).vote&&"contained",onClick:function(){return e.props.handleModalOpen(t,a[t].title,"base.abstain")}},s("base.abstain")),d.a.createElement(E.a,{variant:a[t].voters&&o.find((function(e){return e.address===t}))&&"base.standdown"===o.find((function(e){return e.address===t})).vote&&"contained",onClick:function(){return e.props.handleModalOpen(t,a[t].title,"base.standdown")}},s("base.standdown")))))})):d.a.createElement(y.a,{variant:"body2",gutterBottom:!0},"There are currently no ballots."))}}]),a}(u.Component),q=Object(m.b)()(z),K=a(872),Y=a(716),G=a(574),H=a(640),Q=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).state={loading:!1,secret:"",success:null,error:null,votings:null,expanded:"",modalOpen:!1,currentAddress:"",currentTitle:"",currentVote:"",currentTotalVotes:0,localAuditTrail:[],identifier:"",totalShares:0,shares:0,networkName:"",activeSnackbar:null},e.componentDidMount=function(){p.a.setAssembly(e.props.match.params.assembly).then((function(){e.getIdentifier(),e.getVotings(),e.getSharesTotalSupply(),e.getShares(),e.checkOwner()})).catch((function(e){return console.error(e)}));var t=window.localStorage.getItem(e.props.match.params.assembly)?JSON.parse(window.localStorage.getItem(e.props.match.params.assembly)):[];e.setState({localAuditTrail:t,networkName:Object(Y.a)()}),e.selfUpdate()},e.componentWillUnmount=function(){e.timer&&(clearTimeout(e.timer),e.timer=0)},e.checkOwner=function(){var t=p.a.wallet[0].address;p.a.checkOwner().then((function(a){t===a?!0!==e.props.admin&&e.props.setAdmin(!0):!0===e.props.admin&&e.props.setAdmin(!1)})).catch((function(e){console.error(e)}))},e.getIdentifier=Object(s.a)(r.a.mark((function t(){var a;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.a.getIdentifier();case 2:(a=t.sent)&&e.setState({identifier:a});case 4:case"end":return t.stop()}}),t)}))),e.getShares=Object(s.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{p.a.getShares(p.a.wallet[0].address).then((function(t){return e.setState({shares:t})}))}catch(a){console.error(a)}case 1:case"end":return t.stop()}}),t)}))),e.getSharesTotalSupply=Object(s.a)(r.a.mark((function t(){var a;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.a.getSharesTotalSupply();case 2:(a=t.sent)&&e.setState({totalShares:a});case 4:case"end":return t.stop()}}),t)}))),e.getVotingInfo=function(){var t=Object(s.a)(r.a.mark((function t(a){var n,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,p.a.getVotingInfo(a);case 3:n=t.sent,(s=e.state.votings)[a]=n,e.setState({votings:s}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}(),e.getVotings=Object(s.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=e,t.next=4,p.a.getVotings();case 4:t.t1=t.sent,t.t2={votings:t.t1},t.t0.setState.call(t.t0,t.t2),t.next=12;break;case 9:t.prev=9,t.t3=t.catch(0),console.error(t.t3);case 12:case"end":return t.stop()}}),t,null,[[0,9]])}))),e.castVote=function(){var t=Object(s.a)(r.a.mark((function t(a,n){var s,o;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({loading:!0}),s=e.props.enqueueSnackbar(e.props.t("assemblynew.VoteCast"),{variant:"warning",persist:!0,action:d.a.createElement(H.a,null)}),e.setState({activeSnackbar:s}),t.prev=3,t.t0=a,t.next="base.yes"===t.t0?7:"base.no"===t.t0?10:"base.abstain"===t.t0?13:"base.standdown"===t.t0?16:19;break;case 7:return t.next=9,p.a.voteYes(n,0);case 9:return t.abrupt("break",20);case 10:return t.next=12,p.a.voteNo(n,0);case 12:return t.abrupt("break",20);case 13:return t.next=15,p.a.voteAbstain(n,0);case 15:return t.abrupt("break",20);case 16:return t.next=18,p.a.voteStandDown(n,0);case 18:case 19:return t.abrupt("break",20);case 20:e.setState({loading:!1}),e.props.closeSnackbar(e.state.activeSnackbar),e.props.enqueueSnackbar(e.props.t("assemblyStart.ThanksVote"),{variant:"success",action:function(t){return d.a.createElement(G.a,{snackKey:t,closeSnackbar:e.props.closeSnackbar})}}),t.next=31;break;case 25:t.prev=25,t.t1=t.catch(3),e.setState({loading:!1}),e.props.enqueueSnackbar(e.props.t("assemblyStart.VoteFail"),{variant:"error",action:function(t){return d.a.createElement(G.a,{snackKey:t,closeSnackbar:e.props.closeSnackbar})}}),e.props.closeSnackbar(e.state.activeSnackbar),console.error(t.t1);case 31:e.setState({modalOpen:!1,currentAddress:"",currentTitle:"",currentVote:""}),(o=e.state.localAuditTrail).push({address:n,name:e.state.votings[n].title,vote:a,timestamp:e.props.t("base.dateTime",{date:new Date})}),e.setState({localAuditTrail:o}),window.localStorage.setItem(e.props.match.params.assembly,JSON.stringify(o));case 36:case"end":return t.stop()}}),t,null,[[3,25]])})));return function(e,a){return t.apply(this,arguments)}}(),e.handleChange=function(t){return function(a){e.state.expanded===t?e.setState({expanded:""}):p.a.setVoting(t).then((function(){e.getVotingInfo(t),e.setState({expanded:t})})).catch((function(t){return e.setState({error:t})}))}},e.handleModalOpen=function(t,a,n){e.setState({modalOpen:!0,currentAddress:t,currentTitle:a,currentVote:n})},e.handleModalClose=function(){e.setState({modalOpen:!1})},e.getVotingShare=function(t){var a=t?parseInt(t):0;return e.state.totalShares>0?Math.round(100*a/e.state.totalShares):0},e}return Object(i.a)(a,[{key:"selfUpdate",value:function(){var e=this;this.timer=setTimeout((function(){e.getVotings(),e.getSharesTotalSupply(),e.selfUpdate()}),2e4)}},{key:"render",value:function(){var e=this,t=this.props,a=t.t,n=t.expertmode,r=t.videoOn,s=this.state,o=s.votings,i=s.modalOpen,c=s.expanded,l=s.currentAddress,u=s.currentTitle,m=s.currentVote,p=s.identifier,b=s.localAuditTrail,f=s.loading,V=s.totalShares,T=s.shares,j=s.networkName,_=this.props.match.params,I=_.assembly,A=_.chain;return d.a.createElement(v.a,{item:!0,xs:12,md:r?12:9,lg:r?12:8,className:"defaultpadding"},d.a.createElement(v.a,{container:!0,spacing:2,direction:"row",justify:"center",alignItems:"flex-start"},d.a.createElement(v.a,{item:!0,xs:r?12:null,md:r?6:null,lg:r?8:null},r&&d.a.createElement(g.a,{height:"90vh"},d.a.createElement(K.a,{room:I,serverURL:"https://meet.jit.si",startWithAudioMuted:!0,startWithVideoMuted:!0,name:"",email:"",avatarURL:"",setVideoOn:this.props.setVideoOn}))),d.a.createElement(v.a,{item:!0,xs:12,md:r?6:12,lg:r?4:12},d.a.createElement(y.a,{variant:"h1",gutterBottom:!0},a("assemblyStart.title")," ",p?" - "+p:""),d.a.createElement(y.a,{variant:"body2",gutterBottom:!0},a("base.numberOfShares")+": "+T," ",d.a.createElement("br",null),a("base.numberOfTotalShares")+": "+V),n&&d.a.createElement(g.a,{my:3},d.a.createElement(y.a,{variant:"body2",gutterBottom:!0},"Assembly address: ",I),d.a.createElement(E.a,{disabled:f,color:"primary",variant:"outlined",component:"a",href:"https://"+j+".etherscan.io/address/"+I,target:"_blank",rel:"noreferrer",startIcon:d.a.createElement(C.a,null)},a("base.viewEtherscan")),"\xa0",d.a.createElement(P.a,{text:I,buttonText:a("base.copyAddressToClipboard")})),d.a.createElement(q,{votings:o,loading:f,handleModalOpen:this.handleModalOpen,expertmode:n,localAuditTrail:b,expanded:c,handleChange:this.handleChange,getVotingShare:this.getVotingShare,totalShares:V,networkName:j}),d.a.createElement(g.a,{my:5},d.a.createElement(y.a,{variant:"body2",gutterBottom:!0},a("assemblyStart.finishDescription")),d.a.createElement(E.a,{disabled:f,color:"primary",variant:"outlined",component:h.b,to:"/"+A+"/assembly/"+I+"/close"},a("assemblyStart.finishButton"))),d.a.createElement(S.a,{onClose:this.handleModalClose,"aria-labelledby":"confirmation",open:i},d.a.createElement(k.a,{id:"confirmation"},a("assemblyStart.confirmDescription")),d.a.createElement(w.a,null,d.a.createElement(x.a,{InputProps:{readOnly:!0},fullWidth:!0,label:a("base.agendaItem"),defaultValue:u,variant:"outlined",margin:"normal"}),d.a.createElement(x.a,{InputProps:{readOnly:!0},fullWidth:!0,label:a("base.yourVote"),defaultValue:a(m),variant:"outlined",margin:"normal"})),d.a.createElement(O.a,null,d.a.createElement(E.a,{color:"primary",variant:"outlined",onClick:this.handleModalClose},a("base.cancel")),d.a.createElement(E.a,{color:"primary",variant:"contained",onClick:function(){return e.castVote(m,l)}},a("assemblyStart.confirmButton")))))))}}]),a}(u.Component);t.default=Object(b.f)(Object(m.b)()(Object(f.b)(Q)))},574:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(577),r=a(4),s=a.n(r),o=a(2017),i=a(1991),c=a(575),l=a.n(c);function u(e){var t=s.a.useState(100),a=Object(n.a)(t,2),r=a[0],c=a[1];return s.a.useEffect((function(){c(100);var e=setInterval((function(){c((function(e){return e<=0?0:e-2}))}),100);return function(){clearInterval(e)}}),[]),s.a.createElement("div",{className:"toastSpinnerWrapper"},s.a.createElement(i.a,{size:"small",color:"secondary",onClick:function(){e.closeSnackbar(e.snackKey)}},s.a.createElement(l.a,null)),s.a.createElement(o.a,{variant:"determinate",value:r,color:"secondary",size:36,thickness:2,className:"toastSpinner"}))}},640:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),r=a.n(n),s=a(2017);function o(){return r.a.createElement(s.a,{variant:"indeterminate",color:"secondary",size:30,thickness:2})}},672:function(e,t,a){"use strict";var n=a(31),r=a(32),s=a(34),o=a(33),i=a(4),c=a.n(i),l=a(35),u=a(729),d=a(2006),m=a(734),p=a.n(m),h=a(681),b=a.n(h),f=function(e){Object(s.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).state={success:null},e.handleCopyClick=function(){e.state.success||e.setState({success:!0},(function(){e.timer=setTimeout((function(){e.setState({success:!1})}),800)}))},e}return Object(r.a)(a,[{key:"render",value:function(){return c.a.createElement(u.CopyToClipboard,{text:this.props.text,onCopy:this.handleCopyClick},c.a.createElement(d.a,{variant:"outlined",color:"primary",startIcon:this.state.success?c.a.createElement(b.a,{fontSize:"small"}):c.a.createElement(p.a,{fontSize:"small"})},this.props.buttonText))}}]),a}(i.Component);t.a=Object(l.b)()(f)},716:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r}));var n=function(){return"https://sandbox.truffleteams.com/01b581c6-0ffe-46ce-9dc7-d4d76823077b".split(".")[0].replace("https://","")},r=function(e,t,a,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=window.localStorage.getItem("assemblies")?JSON.parse(window.localStorage.getItem("assemblies")):[],o=!1;s.forEach((function(t){t.address===e&&(o=!0)})),o||(s.push({address:e,chain:t,type:a,datetime:n,identifier:r}),window.localStorage.setItem("assemblies",JSON.stringify(s)))}},872:function(e,t,a){"use strict";var n=a(31),r=a(32),s=a(40),o=a(34),i=a(33),c=a(4),l=a.n(c),u=function(e){Object(o.a)(a,e);var t=Object(i.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).state={isLoading:!0},r._ref=l.a.createRef(),r._onIframeLoad=r._onIframeLoad.bind(Object(s.a)(r)),r._onVideoConferenceEnded=r._onVideoConferenceEnded.bind(Object(s.a)(r)),r}return Object(r.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this._ref.current,a=this.props.room,n=this.props.serverURL;this._conference={room:a,serverURL:n};var r=document.createElement("script");r.async=!0,r.onload=function(){return e._onScriptLoad(t)},r.src="https://meet.jit.si/external_api.js",this._ref.current.appendChild(r),this._loadTimer=setTimeout((function(){e.props.setVideoOn(!1)}),1e4)}},{key:"componentWillUnmount",value:function(){this._loadTimer&&clearTimeout(this._loadTimer),this._api&&this._api.dispose()}},{key:"_onScriptLoad",value:function(e){var t=window.JitsiMeetExternalAPI,a=this._conference.serverURL.replace(/https?:\/\//,""),n={startWithAudioMuted:this.props.startWithAudioMuted,startWithVideoMuted:this.props.startWithVideoMuted};this._api=new t(a,{configOverwrite:n,onload:this._onIframeLoad,parentNode:e,roomName:this._conference.room}),this._api.on("suspendDetected",this._onVideoConferenceEnded),this._api.on("readyToClose",this._onVideoConferenceEnded),this._api.on("videoConferenceJoined",(function(e){console.log("joined")}))}},{key:"_onVideoConferenceEnded",value:function(e){console.log("videoconf ended")}},{key:"_onIframeLoad",value:function(){this._loadTimer&&(clearTimeout(this._loadTimer),this._loadTimer=null),this.setState({isLoading:!1})}},{key:"render",value:function(){return l.a.createElement("div",{className:"jitsi",ref:this._ref},this.state.isLoading&&l.a.createElement("p",null,"Loading"))}}]),a}(c.Component);t.a=u}}]);